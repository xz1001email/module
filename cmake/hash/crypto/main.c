#include <stdio.h>

void printbuf(unsigned char *buf, int len)
{
    int i;
    for(i=0; i<len; i++) {
        if (i && i%16 == 0)
            printf("\n");
        printf("0x%02x ", buf[i]);

    }
    printf("\n");
}


int main()
{


    const char test[] = {
        0x14,0x15,0x63,0x37,0x28,0x45,0x73,0x94,0x51,0x34,0x61,0x92,0x79,0x3b,0xec,0xc4,
        0x29,0xfc,0xdf,0x7d,0x6c,0xaa,0x76,0x23,0x85,0x12,0x1d,0x4e,0x53,0x8e,0xe1,0xd3,
        0x40,0x79,0x54,0xdb,0x7f,0x00,0x00,0x00,0xb8,0x59,0x55,0x55,0x55,0x00,0x00,0x00,
        0x70,0x79,0x54,0xdb,0x7f,0x00,0x00,0x00,0xcc,0x5a,0x55,0x55,0x55,0x00,0x00,0x00,
        0x08,0x01,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xee,
        0x00,0x00,0x00,0x00,0x01,0x23,0x00,0x00
    };

    const char nonce[] = {
        0xf0,0xf5,0xe6,0x45,0xc0,0xbe,0xc5,0xfa,0xd8,0x0c,0x8c,0x44,0x34,0xa2,0xc7,0x02,
        0x4a,0x79,0xd5,0xb6,0xa8,0x03,0x10,0x25,0xe7,0x78,0x06,0xc6,0x03,0xde,0x91,0xf2,
        0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x10,0x11,0x12,0x13,0x14,0x15,0x16,
        0x17,0x18,0x19,0x20,0x16,0x01,0x00
    };

    const char tmpkey[] = {
        0x14,0x15,0x63,0x37,0x28,0x45,0x73,0x94,0x51,0x34,0x61,0x92,0x79,0x3b,0xec,0xc4,
        0x29,0xfc,0xdf,0x7d,0x6c,0xaa,0x76,0x23,0x85,0x12,0x1d,0x4e,0x53,0x8e,0xe1,0xd3,
        0x4c,0xd5,0xdd,0x42,0x39,0x05,0x63,0x08,0x4e,0x3b,0x5b,0x56,0x01,0x83,0x02,0x67,
        0x4d,0x52,0x3e,0x53,0x76,0xb5,0x2c,0x9c,0x38,0xab,0x4b,0xfe,0xa4,0xdf,0x10,0xd4,
        0x08,0x01,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xee,
        0x00,0x00,0x00,0x00,0x01,0x23,0x00,0x00
    };

    const char data[] = { //pass-through
        0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x10,0x11,0x12,0x13,0x14,0x15,0x16,
        0x17,0x18,0x19,0x20,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x20,0x11,0x12,
        0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x10,0x11,0x12,0x13,0x14,0x15,0x16,
        0x17,0x18,0x19,0x20,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x20,0x11,0x12,
        0x08,0x07,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xee,
        0x00,0x00,0x00,0x00,0x01,0x23,0x00,0x00
    };
    unsigned char digest[32];
    int ret;


    ret = atcac_sw_sha2_256(nonce, sizeof(nonce), digest);
    printf("nonce digest ret = %d\n", ret);
    printbuf(digest, sizeof(digest));

    ret = atcac_sw_sha2_256(tmpkey, sizeof(tmpkey), digest);
    printf("digest ret = %d\n", ret);
    printbuf(digest, sizeof(digest));

    ret = atcac_sw_sha2_256(test, sizeof(test), digest);
    printf("digest ret = %d\n", ret);
    printbuf(digest, sizeof(digest));

    return 0;
}

